name: CI

on:
  push:
    branches:
      - '*'
  pull_request:
    branches: [ main ]

jobs:

## Build Back ##

  Test_Build_Back:
    uses: ./.github/workflows/build_back.yml

## Build App ##

  Test_Build_Front:
    uses: ./.github/workflows/build_app.yml
    with:
      expo-token: ${{ secrets.EXPO_TOKEN }}

## Test Backend ##

  Test_Back:
    needs: [ Test_Build_Back, Test_Build_Front ]
    uses: ./.github/workflows/test_back.yml

## Test App ##

## Deployement ##

  Deployement:
    if: github.ref == 'refs/heads/main'
    needs: [ Test_Back ]
    uses: ./.github/workflows/deployment_docker.yml